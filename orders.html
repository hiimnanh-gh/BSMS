<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <title>Lịch sử đơn hàng</title>
    <script src="https://cdn.tailwindcss.com"></script>
  </head>
  <body class="bg-gray-100 p-6">
    <div class="max-w-3xl mx-auto">
      <h1 class="text-2xl font-bold mb-4">Lịch sử đơn hàng</h1>
      <div id="order-list" class="space-y-4"></div>
    </div>

    <script>
      const userId = sessionStorage.getItem("UserID");

      document.addEventListener("DOMContentLoaded", () => {
        fetchOrders();
      });

      async function fetchOrders() {
        try {
          const res = await fetch(
            `http://localhost:5178/Order/GetOrdersByUserId/${userId}`
          );
          const data = await res.json();

          const container = document.getElementById("order-list");
          if (!data || data.length === 0) {
            container.innerHTML = `<p class="text-gray-600">Chưa có đơn hàng nào.</p>`;
            return;
          }

          data.forEach((order, index) => {
            const html = `
    <div class="border p-4 rounded-lg shadow-sm bg-white">
      <h2 class="text-xl font-semibold">Đơn hàng #${index + 1}</h2>
      <p><strong>Người nhận:</strong> ${order.customerName}</p>
      <p><strong>Địa chỉ:</strong> ${order.customerAddress}</p>
      <p><strong>Tổng tiền:</strong> ${order.totalAmount.toLocaleString()}đ</p>
      <p><strong>Phương thức thanh toán:</strong> ${
        order.paymentMethod ?? "Thanh toán khi nhận hàng"
      }</p>
    </div>
  `;
            container.innerHTML += html;
          });
        } catch (err) {
          console.error("Lỗi khi lấy dữ liệu đơn hàng:", err);
          alert("Không thể tải dữ liệu đơn hàng.");
        }
      }
    </script>
  </body>
</html>
